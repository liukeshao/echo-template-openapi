---
description: 
globs: 
alwaysApply: false
---
# API è®¾è®¡æŒ‡å—

æœ¬é¡¹ç›®éµå¾ªç»Ÿä¸€çš„ API è®¾è®¡è§„èŒƒï¼Œç¡®ä¿æ¥å£çš„ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

## ğŸ¯ è®¾è®¡åŸåˆ™

### ç»Ÿä¸€å“åº”æ ¼å¼
æ‰€æœ‰ API å“åº”éƒ½ä½¿ç”¨æ ‡å‡†æ ¼å¼ï¼Œå‚è€ƒ [Response.yaml](mdc:openapi/components/schemas/Response.yaml)ï¼š

```yaml
type: object
properties:
  code:
    type: integer
    description: å“åº”ä»£ç ï¼Œ0è¡¨ç¤ºæˆåŠŸï¼Œé0è¡¨ç¤ºå¤±è´¥
  message:
    type: string
    description: å“åº”æ¶ˆæ¯
  data:
    description: å“åº”æ•°æ®ï¼Œæ ¹æ®å…·ä½“æ¥å£è€Œå®š
```

### HTTP çŠ¶æ€ç è§„èŒƒ
- **ç»Ÿä¸€ä½¿ç”¨ 200** - æ‰€æœ‰å“åº”éƒ½è¿”å› HTTP 200
- **é€šè¿‡ `code` å­—æ®µåŒºåˆ†** - ä¸šåŠ¡æˆåŠŸ/å¤±è´¥é€šè¿‡å“åº”ä½“ä¸­çš„ `code` å­—æ®µåˆ¤æ–­

## ğŸ” è®¤è¯è®¾è®¡

### JWT Bearer Token
ä½¿ç”¨ JWT è¿›è¡Œ API è®¤è¯ï¼Œé…ç½®åœ¨ [openapi.yaml](mdc:openapi/openapi.yaml) ä¸­ï¼š

```yaml
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
```

### è®¤è¯æµç¨‹
1. **æ³¨å†Œ/ç™»å½•** - è·å– access_token å’Œ refresh_token
2. **API è°ƒç”¨** - åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ `Authorization: Bearer <token>`
3. **ä»¤ç‰Œåˆ·æ–°** - ä½¿ç”¨ refresh_token è·å–æ–°çš„ access_token

å‚è€ƒå®ç°ï¼š
- [æ³¨å†Œæ¥å£](mdc:openapi/paths/api_v1_auth_register.yaml)
- [ç™»å½•æ¥å£](mdc:openapi/paths/api_v1_auth_login.yaml)
- [åˆ·æ–°æ¥å£](mdc:openapi/paths/api_v1_auth_refresh.yaml)

## ğŸ“‹ æ•°æ®æ¨¡å‹è®¾è®¡

### è¾“å…¥éªŒè¯
æ‰€æœ‰è¾“å…¥æ¨¡å‹éƒ½åº”åŒ…å«é€‚å½“çš„éªŒè¯è§„åˆ™ï¼š

```yaml
# ç¤ºä¾‹ï¼šç”¨æˆ·æ³¨å†Œè¾“å…¥
type: object
properties:
  username:
    type: string
    minLength: 3
    maxLength: 50
    pattern: '^[a-zA-Z0-9_]+$'
  email:
    type: string
    format: email
  password:
    type: string
    minLength: 8
required:
  - username
  - email
  - password
```

### åˆ†é¡µè®¾è®¡
ä½¿ç”¨ç»Ÿä¸€çš„åˆ†é¡µæ¨¡å¼ï¼Œå‚è€ƒ [PageInput.yaml](mdc:openapi/components/schemas/PageInput.yaml) å’Œ [PageOutput.yaml](mdc:openapi/components/schemas/PageOutput.yaml)ï¼š

```yaml
# åˆ†é¡µè¾“å…¥
page:
  type: integer
  minimum: 1
  default: 1
page_size:
  type: integer
  minimum: 1
  maximum: 100
  default: 10

# åˆ†é¡µè¾“å‡º
total:
  type: integer
  description: æ€»è®°å½•æ•°
page:
  type: integer
  description: å½“å‰é¡µç 
page_size:
  type: integer
  description: æ¯é¡µè®°å½•æ•°
```

## ğŸ·ï¸ æ ‡ç­¾å’Œåˆ†ç»„

### åŠŸèƒ½æ¨¡å—æ ‡ç­¾
åœ¨ [openapi.yaml](mdc:openapi/openapi.yaml) ä¸­å®šä¹‰ï¼š

```yaml
tags:
  - name: è®¤è¯ç®¡ç†
    description: ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä»¤ç‰Œç®¡ç†ç­‰è®¤è¯ç›¸å…³æ¥å£
  - name: ç”¨æˆ·ç®¡ç†
    description: ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢å’Œç®¡ç†æ¥å£

x-tagGroups:
  - name: æ ¸å¿ƒåŠŸèƒ½
    tags:
      - è®¤è¯ç®¡ç†
      - ç”¨æˆ·ç®¡ç†
```

### æ“ä½œ ID å‘½å
ä½¿ç”¨æœ‰æ„ä¹‰çš„ `operationId`ï¼š
- `registerUser` - ç”¨æˆ·æ³¨å†Œ
- `loginUser` - ç”¨æˆ·ç™»å½•
- `getUserProfile` - è·å–ç”¨æˆ·ä¿¡æ¯
- `updateUserProfile` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯

## ğŸ“– æ–‡æ¡£ç¼–å†™è§„èŒƒ

### æ¥å£æè¿°
- **summary**: ç®€çŸ­çš„åŠŸèƒ½æè¿°ï¼ˆ1-2 ä¸ªè¯ï¼‰
- **description**: è¯¦ç»†çš„åŠŸèƒ½è¯´æ˜ï¼Œæ”¯æŒ Markdown
- **tags**: å½’å±çš„åŠŸèƒ½æ¨¡å—

### å‚æ•°è¯´æ˜
- ä¸ºæ¯ä¸ªå‚æ•°æä¾›æ¸…æ™°çš„ `description`
- ä½¿ç”¨åˆé€‚çš„æ•°æ®ç±»å‹å’Œæ ¼å¼
- æ ‡æ˜å¿…éœ€å’Œå¯é€‰å‚æ•°

### å“åº”ç¤ºä¾‹
ä¸ºé‡è¦æ¥å£æä¾›å®Œæ•´çš„å“åº”ç¤ºä¾‹ï¼š

```yaml
responses:
  '200':
    description: ç™»å½•æˆåŠŸ
    content:
      application/json:
        schema:
          $ref: ../components/schemas/AuthResponse.yaml
        example:
          code: 0
          message: "ç™»å½•æˆåŠŸ"
          data:
            access_token: "eyJhbGciOiJIUzI1NiIs..."
            refresh_token: "eyJhbGciOiJIUzI1NiIs..."
            expires_in: 3600
```

## âš ï¸ é”™è¯¯å¤„ç†

### é”™è¯¯å“åº”æ ¼å¼
ç»Ÿä¸€çš„é”™è¯¯å“åº”ç»“æ„ï¼š

```yaml
code: 1001
message: "ç”¨æˆ·åå·²å­˜åœ¨"
data: null
```

### å¸¸è§é”™è¯¯ç è®¾è®¡
- **1xxx** - è®¤è¯ç›¸å…³é”™è¯¯
- **2xxx** - å‚æ•°éªŒè¯é”™è¯¯  
- **3xxx** - ä¸šåŠ¡é€»è¾‘é”™è¯¯
- **9xxx** - ç³»ç»Ÿå†…éƒ¨é”™è¯¯

## ğŸ”„ ç‰ˆæœ¬æ§åˆ¶
- åœ¨ URL ä¸­åŒ…å«ç‰ˆæœ¬å·ï¼š`/api/v1/`
- ä¸»ç‰ˆæœ¬å·å˜æ›´æ—¶åˆ›å»ºæ–°çš„è·¯å¾„ç»„
- å‘åå…¼å®¹çš„å˜æ›´åœ¨åŒä¸€ç‰ˆæœ¬å†…è¿›è¡Œ
